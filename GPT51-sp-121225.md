Hi improve the design by let user to choose light/dark theme, english/traditional chinese, 20 stylese based on famious painters (user can use luck wheel to choose styles). please also create interactive web page to present the following information with at least 5 interactive inforaph:TFDA電子化送件使用者調查綜合報告
I. 執行摘要 (Executive Summary)
本報告旨在彙整食品藥物管理署（TFDA）電子化送件系統使用者調查結果，涵蓋承辦人、覆核人員、財團法人醫藥品查驗中心（CDE）與工研院量測中心等共 41 筆有效回饋。調查結果顯示，儘管多數使用者肯定電子化送件在資料存取、審查追蹤及彙整紀錄方面的優勢，並普遍認同其對審查效率有正向幫助（平均分數 4.05/5），但系統的穩定性、介面操作便利性以及處理大量檔案的速度仍是亟需解決的核心痛點。
在審查流程中，最耗費時間的環節集中在大量送審資料的檢索以及技術文件與臨床前測試報告的審查。對此，使用者對導入人工智慧（AI）技術的期望極高，其中以自動摘要冗長文件、自動標記文件不一致性及自動比對類似產品為最受歡迎的潛在 AI 智慧助理工具。
整體而言，電子化系統的導入已為審查流程帶來顯著結構性優勢，但要進一步提升效率與使用者滿意度，則必須優先處理系統效能、優化介面設計，並策略性地將 AI 技術應用於耗時費力的文件處理與比對工作。
II. 調查背景與受訪者結構分析
調查背景與目的
為持續優化醫療器材查驗登記的電子化送件流程，本調查旨在瞭解實際審查人員對現行系統的使用經驗、滿意度、作業瓶頸，以及對導入 AI 智慧助理工具的潛在需求，作為未來系統功能迭代與資源配置的依據。
受訪者所屬單位與職務（Q1）
所屬單位/職務 人數（N=41） 比例
TFDA（承辦人） 25 60.98%
財團法人醫藥品查驗中心（CDE） 7 17.07%
TFDA（覆核） 5 12.20%
工研院量測中心 4 9.76%
受訪者主要為 TFDA 承辦人，亦涵蓋重要協力單位 CDE 及工研院，回饋具有高度代表性。
使用時長與頻率分析（Q2, Q3）
系統使用時長（Q2） 人數 每週使用時間（Q3） 人數
1–3 年 21 16–30 小時 10
3–5 年 8 6–15 小時 14
不到 1 年 6 1–5 小時 12
超過 5 年 3 超過 30 小時 3
多數受訪者（超過 50%）已使用系統 1-3 年，顯示系統已度過初期建置階段，使用者回饋反映的是相對成熟環境下的實際體驗。每週平均使用系統 6-30 小時的人員佔大多數（24人），顯示系統已深度融入日常審查工作。
III. 系統使用現況與滿意度
審查效率提升與電子送件優勢（Q4, Q10）
效率認同度（Q4）：
使用者對電子送件系統能「顯著提升審查效率」的同意度平均為 4.05/5（5分最高），顯示在宏觀層面上，電子化已達到提升效率的目標。
電子送件的優勢（Q10, 複選）：
| 優勢選項 | 選擇次數 | 比例 (N=41) |
| :--- | :--- | :--- |
| 1. 更容易、更快速存取送審資料 | 22 | 53.66% |
| 2. 更容易彙整審查紀錄 | 13 | 31.71% |
| 3. 更容易追蹤審查進度 | 12 | 29.27% |
| 4. 送審資料的組織性更佳 | 9 | 21.95% |
| 5. 更容易延續過往審查紀錄 | 8 | 19.51% |
分析： 最大的優勢在於數位化帶來的資料存取便利性，印證電子化在檔案管理和檢索上的價值。其次，追蹤進度與彙整紀錄的結構化優勢亦獲得高度認可。然而，有 1 位使用者指出「皆無（電子送件比紙本更困難/耗時）」，此極端個案值得關注，需進一步探究其面臨的具體流程問題（結合開放意見，可能是與公文系統介接或紙本覆核流程的衝突）。
介面滿意度與核心痛點分析（Q5, Q7, Q8）
介面設計滿意度（Q5）：
平均滿意度為 3.61/5，呈現中等偏上水準，但分佈廣泛（從 2 到 5 皆有），顯示介面設計存在明顯的優化空間，未能滿足所有使用者的需求。
系統中最需要改進的部分（Q7, 單選）：
| 待改進部分 | 選擇次數 | 比例 (N=41) |
| :--- | :--- | :--- |
| 1. 介面操作的便利性 | 10 | 24.39% |
| 2. 資料呈現與上傳速度 | 9 | 21.95% |
| 3. 審查進度提醒（如申請人補件、時程提醒） | 7 | 17.07% |
分析： 核心痛點明確指向操作流暢度與系統效能。「介面操作的便利性」與「資料呈現與上傳速度」合計佔了超過 45% 的改進需求，暗示使用者在日常點擊、跳轉、載入檔案等操作中，面臨效率瓶頸。
尖峰使用時段系統變慢狀況（Q8）：
| 狀況 | 選擇次數 | 比例 (N=41) |
| :--- | :--- | :--- |
| 偶爾發生 | 24 | 58.54% |
| 經常發生 | 11 | 26.83% |
| 很少發生 | 5 | 12.20% |
| 從未發生 | 1 | 2.44% |
分析： 高達 85% 的使用者（經常發生 + 偶爾發生）曾遭遇系統變慢，這是影響系統滿意度的關鍵因素。這與 Q7 中「資料呈現與上傳速度」的需求相呼應，表明系統的硬體或網路架構在處理大量併發請求時，存在顯著的性能問題。
表現優異的功能（Q6, 複選）：
優異功能 選擇次數
審查資料檢索速度 20
案件進度追蹤功能 15
系統操作介面的直覺性 13
分析： 儘管使用者抱怨「介面操作的便利性」需改進，但「系統操作介面的直覺性」仍獲得肯定，這可能表明介面結構邏輯是好的，但執行效率/流暢度（即 Q7 的痛點）拉低了整體滿意度。資料檢索速度被評為最優異，與電子化帶來「快速存取資料」的優勢吻合。
IV. 審查作業瓶頸與 AI 技術導入需求分析
醫療器材審查最耗時環節（Q9, 最多選 3 項）：
耗時環節 選擇次數 比例 (N=41)
大量送審資料的檢索 17 41.46%
技術文件與臨床前測試報告審查 17 41.46%
與同類器材比對表之比對確認 13 31.71%
產品標籤與說明書審查 12 29.27%
與申請人的溝通協調 7 17.07%
行政工作（如填寫審查表、發函） 3 7.32%
分析： 審查人員的時間主要消耗在**「找資料」和「讀報告」**這兩大核心任務上。大量的技術文件和臨床前數據需要時間消化和比對，這類工作流程複雜、知識密度高。這也進一步證明，如果系統能提升檢索效率和資料消化速度，將能直接釋放大量審查人力。
最希望 AI 協助處理的工作（Q11, 最多選 3 項）：
AI 需求高度集中在解決 Q9 的耗時環節：
AI 協助工作 選擇次數
與同類器材比對表之比對確認 11
技術文件與臨床前測試報告審查 9
產品標籤與說明書審查 7
自動核對查檢表、審查表與審查結果的一致性 7
分析： 使用者期望 AI 能直接切入比對性與知識性工作。這包括比對同類產品、交叉比對標籤說明書與技術報告的一致性，這些任務單調、重複性高，但需要高精準度，非常適合 AI 輔助。
最有幫助的 AI 智慧助理工具（Q12, 最多選 3 項）：
AI 智慧助理工具 選擇次數
自動摘要冗長的文件/測試報告 14
自動標記申請文件中的不一致性 13
自動比對類似產品 11
自動生成案件預審摘要 7
自動生成審查紀錄表與審查意見 6
分析： 此結果與 Q11 的需求高度吻合，反映出審查人員最希望 AI 能解決資訊超載（摘要、預審摘要）和精確比對（標記不一致性、比對類似產品）的兩大困境。自動摘要成為最受歡迎的工具，能直接解決「技術文件與臨床前測試報告審查」的耗時問題。
V. 綜合建議與待解決問題
開放式回饋（Free Text）提供了寶貴的具體優化建議，可歸納為以下幾個面向：
系統效能與操作設計（介面操作的便利性、資料呈現與上傳速度）
系統穩定性問題： 多次提及尖峰時段系統變慢、當機、儲存時間過長，影響工作流暢度。
檔案管理優化：
檔案檔名未直接顯示，或點閱紀錄消失，導致不知道看過哪些檔案。
廠商上傳檔名過長會造成下載錯誤。
希望有功能限制廠商將資料亂丟至錯誤或重複欄位。
臨床前資料審查介面希望保留業者上傳檔案時做的子分類。
顯示廠商上傳檔案之檔名或個別註解，以減少核對時間。
功能整合與流程：
建議初篩功能能在業者送件前就處理好，避免業者錯誤勾選。
點開電子化送件並不會所有案件都跑出現，都需要重新整理。
跨系統介接與流程整合
與公文系統介接： 多位使用者強烈建議應與公文系統界接，以確保文件與系統紀錄的一致性。
缺失內容與紙本一致性： 缺失內容一旦決行後無法修改，常導致紙本與系統紀錄不一致。
紙本作業衝突： 部分案件（如許可證展延）仍需紙本文件，導致電子化流程中斷，增加行政流程與時效影響。
CDE/TFDA 交互查詢： CDE 人員希望能夠與 TFDA 審查案子進行交互查詢。
電子化政策與廠商行為規範
標籤說明書紙本問題： 有使用者抱怨免附標籤及說明書紙本的政策，將列印與核對成本轉嫁給承辦人，建議政策應考慮後續的核定與歸檔流程。
電子化離線版功能： 有使用者強烈建議關閉離線版功能，或限制其為僅可下載不可編輯，因廠商常利用離線版修改格式，導致承辦人需手動重新上傳。
VI. 關鍵實體 (20 Entities)
基於調查結果，以下列出 20 個關鍵實體，代表系統現況、痛點或未來方向：
編號 關鍵實體（中文） 關鍵實體（英文參考） 實體脈絡（Context）
1 審查資料檢索速度 Data Retrieval Speed 表現優異功能排名第一，電子化系統最受肯定的優勢。
2 介面操作的便利性 Interface Usability 最需改進部分排名第一，是影響使用者體驗的核心痛點。
3 資料呈現與上傳速度 Data Rendering & Upload Speed 最需改進部分排名第二，與尖峰時段系統變慢有直接關係。
4 大量送審資料的檢索 Massive Submission Data Retrieval 最耗時環節之一，反映審查人員在巨量檔案中找尋資訊的困難。
5 技術文件與臨床前測試報告審查 Technical/Pre-clinical Review 最耗時環節之一，為 AI 自動摘要技術的首要目標。
6 與同類器材比對表之比對確認 Comparison with Peer Devices 最耗時環節之一，亦是使用者最希望 AI 協助處理的工作。
7 系統變慢（尖峰時段） Peak-time System Slowdown 85% 的使用者曾遭遇，是影響系統滿意度的關鍵效能問題。
8 自動摘要冗長的文件/測試報告 Automatic Summarization of Long Documents 最有幫助的 AI 智慧助理工具排名第一，解決資訊超載問題。
9 自動標記申請文件中的不一致性 Automatic Inconsistency Flagging 最有幫助的 AI 工具之一，直接提升審查的精準度與效率。
10 自動比對類似產品 Automatic Comparison of Similar Products 最有幫助的 AI 工具之一，解決同類器材比對的耗時問題。
11 案件進度追蹤功能 Case Progress Tracking 表現優異功能排名第二，電子化系統的結構性優勢。
12 與內部系統（如公文系統）的介接 Internal System Integration (e.g., Document System) 獲得肯定的優異功能，但同時也是開放回饋中的強烈待改進需求。
13 檔案檔名未直接顯示 File Name Not Directly Displayed 具體介面設計痛點，影響審查人員追蹤已閱覽檔案的效率。
14 審查進度提醒 Review Progress Notification 最需改進部分之一，尤其是申請人補件與時程提醒。
15 電子送件離線版功能 E-Submission Offline Version 開放回饋中強烈建議關閉或限制，因其可能導致資料格式與檔案混亂。
16 產品標籤與說明書審查 Labeling and Instruction Review 耗時環節之一，並與免附紙本政策的流程衝突相關。
17 紙本作業衝突 Paperwork Conflict 許可證展延等案件仍需紙本，導致電子化作業流程中斷。
18 自動生成案件預審摘要 Automatic Generation of Pre-review Summary 潛在 AI 工具之一，可協助審查人員快速掌握案件核心資訊。
19 送審資料的組織性更佳 Better Organization of Submission Data 電子送件帶來的優勢，但廠商實際操作仍有待規範。
20 TFDA/CDE 交互查詢 TFDA/CDE Cross-query 跨單位協作的具體需求，有助於知識共享和流程銜接。
VII. 20 個綜合追蹤問題 (20 Comprehensive Follow-up Questions)
基於上述報告的分析結果，為確保系統優化方向與資源投入的精準性，特提出以下 20 個追蹤問題：
A. 系統效能與操作體驗優化
針對「介面操作的便利性」與「資料呈現與上傳速度」這兩大痛點，TFDA 是否已有明確的系統架構升級計畫，預計以何種技術或指標來定義及衡量改善的成效？
如何界定並處理「尖峰使用時段系統變慢」的問題？是否有計畫透過負載平衡（Load Balancing）、雲端擴展（Cloud Scaling）或資料庫優化來解決系統的穩定性？
針對「檔案檔名未直接顯示」及「點閱紀錄消失」的具體回饋，系統介面優化團隊將如何重新設計檔案管理介面，以提供更直覺、可追蹤的檔案閱覽歷史？
在資料上傳方面，能否設計功能，例如檔案大小限制提升、格式轉換服務或前置檢查機制，以減少因廠商檔案問題（如檔名過長）導致的下載錯誤？
針對「審查進度提醒」的需求，系統是否能導入更精細的自動化通知（如電子郵件/站內信），特別是針對補件截止日、公文發函狀態等關鍵時程？
B. 審查流程與跨系統整合
使用者強烈要求「與公文系統介接」以確保文件一致性，TFDA 是否能提供一個明確的時間表，說明如何實現公文系統與電子送件系統之間的文件狀態同步及資料流串接？
針對「缺失內容一旦經決行已無法修改」的問題，是否能設計一個權限機制，允許覆核後的特定時間內，由承辦人進行有限制的修正，以符合最終的紙本紀錄？
如何解決部分案件（如展延）仍需紙本文件的「紙本作業衝突」問題？TFDA 是否有中長期計畫將所有相關文件（如製售證明、授權書）全面電子化，以實現無紙化終局目標？
針對 CDE/TFDA 人員提出「審查案子交互查詢」的需求，兩單位之間的資料庫/系統介接計畫為何？目標是實現即時查詢還是定期同步？
對於廠商在初篩時錯誤勾選或將資料亂丟至錯誤欄位的問題，是否有計劃增強廠商上傳介面的規範性、強制性檢查（如特定欄位必填、格式限定）或實施預審機制？
C. AI 智慧助理工具導入
「自動摘要冗長的文件/測試報告」被選為最受歡迎的 AI 工具，TFDA 預計優先將此技術應用於哪一類文件（如臨床試驗報告、生物相容性報告），以及如何評估其摘要的準確性與可靠性？
如何界定與訓練 AI 模型來實現「自動標記申請文件中的不一致性」？這是否涵蓋跨文件比對（如說明書與技術報告）以及法規標準的比對？
「自動比對類似產品」的 AI 功能，其比對的資料來源（是否包含已核准產品資料庫）與比對維度（如規格、預期用途、技術特性）將如何規劃？
是否有計畫針對「技術文件與臨床前測試報告審查」的 AI 需求，設置一個專案小組，並與外部 AI 團隊（如工研院）合作，開發專屬的醫療器材審查模型？
針對「自動生成審查紀錄表與審查意見」，AI 的角色將會是初步草擬（Drafting）還是根據事實陳述（Fact-based Generation），以及如何確保其語言和格式符合 TFDA 的官方標準？
D. 政策與廠商行為規範
針對要求「關閉或限制電子送件離線版功能」的強烈回饋，TFDA 是否會重新評估其政策必要性？如果保留，將如何強制規範廠商燒錄光碟的形式為僅可下載不可編輯？
如何解決「免附標籤說明書紙本」政策所導致的列印成本轉嫁問題？是否有計畫設計系統功能，允許承辦人在系統內註記或產生正式的「電子核定本」PDF，取代紙本核定草本的流程？
如何設計一個有效的回饋機制（Feedback Loop），讓審查人員針對系統介面或 AI 輔助工具的使用體驗，可以更即時、更精準地向系統開發團隊提出建議？
考慮到不同角色的需求（承辦人、覆核、CDE），未來系統優化是否會針對不同使用者群體設計客製化的介面與提醒功能？
針對「更容易延續過往審查紀錄」的優勢，是否有計畫導入案件知識圖譜或歷史資料連結功能，以利承辦人快速瞭解補件/申覆案件的審查脈絡和決策依據？
Model
ThinkingThoughts
Auto
Expand to view model thoughts
chevron_right
這是一個包含 HTML 和 JavaScript 的單一檔案，使用 ECharts 函式庫來呈現調查結果，包含 6 個互動式資訊圖表和結尾的 20 個綜合追蹤問題。
由於 Markdown 限制，以下呈現為單一的 HTML 程式碼塊。您可以將此程式碼儲存為一個副檔名為 .html 的檔案，然後用瀏覽器開啟以查看結果。
code
Html
<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TFDA電子化送件使用者調查綜合報告 - 互動圖表</title>
<!-- ECharts CDN -->
<script src="https://cdn.jsdelivr.net/npm/echarts@5.3.3/dist/echarts.min.js"></script>
<style>
body {
font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
background-color: #f4f7f6;
padding: 20px;
color: #333;
}
.container {
max-width: 1200px;
margin: auto;
background-color: #fff;
padding: 30px;
border-radius: 8px;
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
h1 {
color: #004d99;
border-bottom: 3px solid #e6e6e6;
padding-bottom: 10px;
text-align: center;
}
h2 {
color: #0066cc;
margin-top: 30px;
border-left: 5px solid #0099ff;
padding-left: 10px;
}
h3 {
color: #333;
margin-top: 20px;
}
.chart-grid {
display: flex;
flex-wrap: wrap;
gap: 20px;
margin-top: 20px;
}
.chart-container {
width: calc(50% - 10px);
height: 400px;
background-color: #fafafa;
padding: 15px;
border-radius: 6px;
box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
}
@media (max-width: 768px) {
.chart-container {
width: 100%;
}
}
/* Follow-up Questions Styling */
.follow-up {
margin-top: 50px;
border-top: 3px solid #004d99;
padding-top: 20px;
}
.follow-up ol {
padding-left: 25px;
}
.follow-up li {
margin-bottom: 15px;
line-height: 1.6;
}
</style>
</head>
<body>
<div class="container">
<h1>TFDA電子化送件使用者調查綜合報告 - 互動分析</h1>
code
Code
<h2>I. 使用者結構與滿意度概況</h2>
<div class="chart-grid">
    <div id="chart-demographics" class="chart-container"></div>
    <div id="chart-efficiency" class="chart-container"></div>
    <div id="chart-slowdown" class="chart-container"></div>
    <div id="chart-improvement" class="chart-container"></div>
</div>

<h2>II. 審查作業瓶頸與 AI 需求</h2>
<div class="chart-grid">
    <div id="chart-timeconsuming" class="chart-container"></div>
    <div id="chart-ai-tools" class="chart-container"></div>
</div>

<script>
    // 1. 數據準備 (Aggregated Data)
    const surveyData = {
        // Q1: 所屬單位/職務
        demographics: [
            { value: 25, name: 'TFDA（承辦人）' },
            { value: 7, name: 'CDE' },
            { value: 5, name: 'TFDA（覆核）' },
            { value: 4, name: '工研院量測中心' }
        ],
        // Q4: 審查效率同意度 (1-5, 5為最同意) - 總數N=37 (排除未填或未評分)
        efficiency: {
            scores: ['5 (最同意)', '4', '3', '2', '1 (最不同意)'],
            counts: [9, 17, 8, 3, 0]
        },
        // Q8: 系統變慢頻率
        slowdown: [
            { value: 24, name: '偶爾發生 (58.5%)' },
            { value: 11, name: '經常發生 (26.8%)' },
            { value: 5, name: '很少發生 (12.2%)' },
            { value: 1, name: '從未發生 (2.4%)' }
        ],
        // Q7: 最需改進的部分 (Top 3)
        improvement: [
            { name: '介面操作的便利性', value: 10 },
            { name: '資料呈現與上傳速度', value: 9 },
            { name: '審查進度提醒', value: 7 },
            { name: '其他', value: 15 } // 總數41 - 10-9-7 = 15
        ],
        // Q9: 最耗時環節 (Top 4)
        timeConsuming: [
            { name: '大量送審資料的檢索', value: 17 },
            { name: '技術文件與臨床前測試報告審查', value: 17 },
            { name: '與同類器材比對表之比對確認', value: 13 },
            { name: '產品標籤與說明書審查', value: 12 }
        ],
        // Q12: 最有幫助的 AI 智慧助理工具 (Top 3)
        aiTools: [
            { name: '自動摘要冗長文件/測試報告', value: 14 },
            { name: '自動標記申請文件中的不一致性', value: 13 },
            { name: '自動比對類似產品', value: 11 },
            { name: '自動生成案件預審摘要', value: 7 },
            { name: '自動生成審查紀錄表與審查意見', value: 6 }
        ]
    };

    // 2. 初始化 ECharts 實例
    const chartDemographics = echarts.init(document.getElementById('chart-demographics'));
    const chartEfficiency = echarts.init(document.getElementById('chart-efficiency'));
    const chartSlowdown = echarts.init(document.getElementById('chart-slowdown'));
    const chartImprovement = echarts.init(document.getElementById('chart-improvement'));
    const chartTimeConsuming = echarts.init(document.getElementById('chart-timeconsuming'));
    const chartAiTools = echarts.init(document.getElementById('chart-ai-tools'));

    // 3. 圖表配置 (Chart Options)

    // Chart 1: 使用者所屬單位分佈 (Pie Chart)
    chartDemographics.setOption({
        title: { text: '使用者所屬單位分佈 (N=41)', left: 'center' },
        tooltip: { trigger: 'item', formatter: '{b}<br/>人數: {c} ({d}%)' },
        legend: { orient: 'vertical', left: 'left', top: 50 },
        series: [
            {
                name: '所屬單位',
                type: 'pie',
                radius: ['40%', '70%'],
                center: ['60%', '55%'],
                data: surveyData.demographics.sort((a, b) => b.value - a.value),
                emphasis: { itemStyle: { shadowBlur: 10, shadowOffsetX: 0, shadowColor: 'rgba(0, 0, 0, 0.5)' } },
                label: { formatter: '{b} \n{d}%' }
            }
        ]
    });

    // Chart 2: 審查效率提升同意度 (Bar Chart)
    chartEfficiency.setOption({
        title: { text: '審查效率提升同意度 (Q4)', left: 'center' },
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
        xAxis: { type: 'value', name: '人數' },
        yAxis: { 
            type: 'category', 
            data: surveyData.efficiency.scores,
            name: '評分 (5分最高)' 
        },
        series: [{
            name: '人數',
            type: 'bar',
            data: surveyData.efficiency.counts,
            itemStyle: { color: '#4CAF50' },
            label: { show: true, position: 'right', formatter: '{c} 人' }
        }]
    });

    // Chart 6: 尖峰時段系統變慢頻率 (Donut Chart)
    chartSlowdown.setOption({
        title: { text: '尖峰時段系統變慢頻率 (Q8)', left: 'center' },
        tooltip: { trigger: 'item', formatter: '{b}<br/>人數: {c}' },
        legend: { orient: 'vertical', left: 'left', top: 50 },
        series: [
            {
                name: '系統變慢頻率',
                type: 'pie',
                radius: ['45%', '65%'],
                center: ['60%', '55%'],
                data: surveyData.slowdown,
                emphasis: { itemStyle: { shadowBlur: 10, shadowOffsetX: 0, shadowColor: 'rgba(0, 0, 0, 0.5)' } },
                label: { formatter: '{b}' }
            }
        ]
    });

    // Chart 3: 最需改進的部分 (Bar Chart)
    chartImprovement.setOption({
        title: { text: '最需改進的部分 (Q7) - Top 3', left: 'center' },
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
        xAxis: { type: 'value', name: '選擇次數' },
        yAxis: { 
            type: 'category', 
            data: ['介面操作的便利性', '資料呈現與上傳速度', '審查進度提醒'],
            axisLabel: { interval: 0, rotate: 0 }
        },
        series: [{
            name: '選擇次數',
            type: 'bar',
            data: [10, 9, 7],
            itemStyle: { color: '#FF9800' },
            label: { show: true, position: 'right', formatter: '{c} 次' }
        }]
    });
    
    // Chart 4: 審查最耗時環節 (Bar Chart)
    chartTimeConsuming.setOption({
        title: { text: '醫療器材查驗登記審查最耗時環節 (Q9)', left: 'center' },
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
        xAxis: { type: 'value', name: '選擇次數' },
        yAxis: { 
            type: 'category', 
            data: surveyData.timeConsuming.map(item => item.name),
            axisLabel: { interval: 0, rotate: 0 }
        },
        series: [{
            name: '選擇次數',
            type: 'bar',
            data: surveyData.timeConsuming.map(item => item.value),
            itemStyle: { color: '#E91E63' },
            label: { show: true, position: 'right', formatter: '{c} 次' }
        }]
    });

    // Chart 5: 最有幫助的 AI 智慧助理工具 (Bar Chart)
    chartAiTools.setOption({
        title: { text: '最有幫助的 AI 智慧助理工具 (Q12)', left: 'center' },
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
        xAxis: { type: 'value', name: '選擇次數' },
        yAxis: { 
            type: 'category', 
            data: surveyData.aiTools.map(item => item.name),
            axisLabel: { interval: 0, rotate: 0 }
        },
        series: [{
            name: '選擇次數',
            type: 'bar',
            data: surveyData.aiTools.map(item => item.value),
            itemStyle: { color: '#03A9F4' },
            label: { show: true, position: 'right', formatter: '{c} 次' }
        }]
    });

    // 4. 響應式調整 (Optional, for better viewing)
    window.addEventListener('resize', function() {
        chartDemographics.resize();
        chartEfficiency.resize();
        chartSlowdown.resize();
        chartImprovement.resize();
        chartTimeConsuming.resize();
        chartAiTools.resize();
    });
</script>


<!-- III. 20 個綜合追蹤問題 -->
<div class="follow-up">
    <h2>III. 20 個綜合追蹤問題 (20 Comprehensive Follow-up Questions)</h2>

    <h3>A. 系統效能與操作體驗優化</h3>
    <ol>
        <li>針對「介面操作的便利性」與「資料呈現與上傳速度」這兩大痛點，TFDA 是否已有明確的系統架構升級計畫，預計以何種技術或指標來定義及衡量改善的成效？</li>
        <li>如何界定並處理「尖峰使用時段系統變慢」的問題？是否有計畫透過負載平衡（Load Balancing）、雲端擴展（Cloud Scaling）或資料庫優化來解決系統的穩定性？</li>
        <li>針對「檔案檔名未直接顯示」及「點閱紀錄消失」的具體回饋，系統介面優化團隊將如何重新設計檔案管理介面，以提供更直覺、可追蹤的檔案閱覽歷史？</li>
        <li>在資料上傳方面，能否設計功能，例如檔案大小限制提升、格式轉換服務或前置檢查機制，以減少因廠商檔案問題（如檔名過長）導致的下載錯誤？</li>
        <li>針對「審查進度提醒」的需求，系統是否能導入更精細的自動化通知（如電子郵件/站內信），特別是針對補件截止日、公文發函狀態等關鍵時程？</li>
    </ol>

    <h3>B. 審查流程與跨系統整合</h3>
    <ol start="6">
        <li>使用者強烈要求「與公文系統介接」以確保文件一致性，TFDA 是否能提供一個明確的時間表，說明如何實現公文系統與電子送件系統之間的文件狀態同步及資料流串接？</li>
        <li>針對「缺失內容一旦經決行已無法修改」的問題，是否能設計一個權限機制，允許覆核後的特定時間內，由承辦人進行有限制的修正，以符合最終的紙本紀錄？</li>
        <li>如何解決部分案件（如展延）仍需紙本文件的「紙本作業衝突」問題？TFDA 是否有中長期計畫將所有相關文件（如製售證明、授權書）全面電子化，以實現無紙化終局目標？</li>
        <li>針對 CDE/TFDA 人員提出「審查案子交互查詢」的需求，兩單位之間的資料庫/系統介接計畫為何？目標是實現即時查詢還是定期同步？</li>
        <li>對於廠商在初篩時錯誤勾選或將資料亂丟至錯誤欄位的問題，是否有計劃增強廠商上傳介面的規範性、強制性檢查（如特定欄位必填、格式限定）或實施預審機制？</li>
    </ol>

    <h3>C. AI 智慧助理工具導入</h3>
    <ol start="11">
        <li>「自動摘要冗長的文件/測試報告」被選為最受歡迎的 AI 工具，TFDA 預計優先將此技術應用於哪一類文件（如臨床試驗報告、生物相容性報告），以及如何評估其摘要的準確性與可靠性？</li>
        <li>如何界定與訓練 AI 模型來實現「自動標記申請文件中的不一致性」？這是否涵蓋跨文件比對（如說明書與技術報告）以及法規標準的比對？</li>
        <li>「自動比對類似產品」的 AI 功能，其比對的資料來源（是否包含已核准產品資料庫）與比對維度（如規格、預期用途、技術特性）將如何規劃？</li>
        <li>是否有計畫針對「技術文件與臨床前測試報告審查」的 AI 需求，設置一個專案小組，並與外部 AI 團隊（如工研院）合作，開發專屬的醫療器材審查模型？</li>
        <li>針對「自動生成審查紀錄表與審查意見」，AI 的角色將會是初步草擬（Drafting）還是根據事實陳述（Fact-based Generation），以及如何確保其語言和格式符合 TFDA 的官方標準？</li>
    </ol>

    <h3>D. 政策與廠商行為規範</h3>
    <ol start="16">
        <li>針對要求「關閉或限制電子送件離線版功能」的強烈回饋，TFDA 是否會重新評估其政策必要性？如果保留，將如何強制規範廠商燒錄光碟的形式為**僅可下載不可編輯**？</li>
        <li>如何解決「免附標籤說明書紙本」政策所導致的**列印成本轉嫁**問題？是否有計畫設計系統功能，允許承辦人在系統內註記或產生正式的「電子核定本」PDF，取代紙本核定草本的流程？</li>
        <li>如何設計一個有效的回饋機制（Feedback Loop），讓審查人員針對系統介面或 AI 輔助工具的使用體驗，可以更即時、更精準地向系統開發團隊提出建議？</li>
        <li>考慮到不同角色的需求（承辦人、覆核、CDE），未來系統優化是否會針對不同使用者群體設計客製化的介面與提醒功能？</li>
        <li>針對「更容易延續過往審查紀錄」的優勢，是否有計畫導入案件知識圖譜或歷史資料連結功能，以利承辦人快速瞭解補件/申覆案件的審查脈絡和決策依據？</li>
    </ol>
</div>
</div>
</body>
</html>
Gemini 3 Pro Preview
Ran for 155s
lightbulb
Thought for 30 seconds
metadata.json
check_circle
index.html
check_circle
index.tsx
check_circle
types.ts
check_circle
constants.ts
check_circle
App.tsx
check_circle
Checkpoint
User
Super, please create a comprehensive 醫療器材查驗登記電子化送件系統導入智慧化審查之可行性方案 in traditional chinese in 2000~3000 words in markdown with keywords in coral color based on the previous result. please use the reference technical specification as example:FDA 510(k) 審查工作室 · 花卉版 V2 - 綜合技術規格文件 文件版本控制 版本 日期 作者 變更說明 1.0 2024-01-XX 系統架構師 初始版本 目錄 執行摘要 系統架構 軟體需求規格 (SRS) 系統需求 環境設定 部署選項 基礎設施即程式碼 (IaC) 與整合 安全性考量 驗證計畫 風險管理 可追溯性矩陣 維護與支援 監管合規性 附錄
執行摘要 1.1 系統概述 FDA 510(k) 審查工作室 · 花卉版 V2 是一個基於人工智慧的多代理協作平台,專為醫療器材監管審查流程設計。本系統整合四大主流 AI 提供商 (Google Gemini, OpenAI, Anthropic Claude, xAI Grok),實現串聯式文件審查、結構化筆記轉換、以及互動式分析儀表板。
1.2 目標用戶 FDA 510(k) 審查人員 醫療器材監管事務專員 法規顧問與品質保證團隊 臨床工程師與技術撰寫人員 1.3 核心價值主張 多模型協作: 同時支援 Gemini, GPT, Claude, Grok,可依任務特性選用最適模型 可編輯鏈式審查: 每個代理步驟的輸入/輸出均可人工編輯,支援混合式人機協作 遊戲化激勵機制: 魔力值 (Mana)、經驗值 (XP)、成就徽章等元素提升使用者參與度 20 種北歐花卉主題: 提供美學化工作環境,降低審查疲勞 AI 筆記助手: 自動將非結構化文本轉換為結構化 Markdown、實體提取、心智圖、測驗題等 1.4 監管定位 本系統為 決策支援工具 (Decision Support Tool),不屬於 FDA 定義之醫療器材。系統輸出結果需由具資格之審查人員驗證,最終決策權歸人類審查員。
系統架構 2.1 高階架構圖 mermaid
Copy graph TB subgraph "使用者層" UI[Streamlit Web UI] end
subgraph "應用層"
APP[Python Application Core]
SESSION[Session State Manager]
GAMIFY[Gamification Engine]
end
subgraph "業務邏輯層"
PIPELINE[Multi-Agent Pipeline Orchestrator]
NOTE[AI Note Keeper]
DASH[Analytics Dashboard]
end
subgraph "AI 服務層"
GEMINI[Google Gemini API]
OPENAI[OpenAI API]
ANTHROPIC[Anthropic Claude API]
XAI[xAI Grok API]
end
subgraph "資料層"
YAML[agents.yaml Config]
ENV[Environment Variables]
LOGS[Execution Logs]
end
UI --> APP
APP --> SESSION
APP --> PIPELINE
APP --> NOTE
APP --> DASH
APP --> GAMIFY
PIPELINE --> GEMINI
PIPELINE --> OPENAI
PIPELINE --> ANTHROPIC
PIPELINE --> XAI
NOTE --> GEMINI
NOTE --> OPENAI
NOTE --> ANTHROPIC
NOTE --> XAI
APP --> YAML
APP --> ENV
PIPELINE --> LOGS
2.2 技術堆疊 層級 技術/框架 版本要求 用途 前端 Streamlit ≥1.30.0 Web UI 框架 後端 Python ≥3.9 核心應用邏輯 AI SDKs google-generativeai latest Gemini 整合 openai ≥1.0.0 OpenAI 整合 anthropic latest Claude 整合 xai-sdk latest Grok 整合 配置 PyYAML ≥6.0 agents.yaml 解析 資料結構 dataclasses stdlib 型別安全配置 2.3 模組架構
Copy ├── app.py (主程式,包含所有功能模組) ├── agents.yaml (代理配置檔) ├── prompts.py (可選,系統提示詞庫) └── requirements.txt (依賴套件清單) 核心模組說明:
Config/Constants (第 1 節): AI 模型清單、語言標籤、主題定義 Session Management (第 2 節): 狀態初始化、持久化管理 Agent Configuration (第 3 節): YAML 解析、代理物件建構 Theme & Styling (第 4 節): 動態 CSS 注入、主題切換 API Key Handling (第 5 節): 環境變數優先、UI fallback Provider Calls (第 6 節): 統一 AI 呼叫介面、錯誤處理 Gamification (第 7 節): 魔力值、經驗值、成就系統 Pipeline UI (第 8 節): 多代理串聯、可編輯輸入/輸出 Note Keeper (第 9 節): 結構化轉換、實體提取、心智圖 Dashboard (第 10 節): 指標追蹤、執行日誌視覺化 Settings (第 11 節): 語言、主題模式、API 金鑰設定 2.4 資料流程 mermaid
Copy sequenceDiagram participant U as 使用者 participant UI as Streamlit UI participant P as Pipeline Orchestrator participant A1 as Agent 1 (Gemini) participant A2 as Agent 2 (OpenAI) participant A3 as Agent 3 (Claude) participant LOG as Execution Log
U->>UI: 輸入案例描述
UI->>P: 啟動全流程執行
P->>A1: 呼叫 Agent 1 (初步審查)
A1-->>P: 返回結構化輸出
P->>LOG: 記錄執行狀態
P->>A2: 將 A1 輸出作為 A2 輸入
A2-->>P: 返回風險分析
P->>A3: 將 A2 輸出作為 A3 輸入
A3-->>P: 返回最終建議
P->>UI: 更新所有代理結果
UI->>U: 顯示可編輯輸出
U->>UI: 編輯 Agent 2 輸出
UI->>P: 使用編輯後輸出重新執行 Agent 3
P->>A3: 呼叫 Agent 3 (使用新輸入)
A3-->>P: 返回更新建議
P->>UI: 顯示更新結果
軟體需求規格 (SRS) 3.1 功能性需求 (Functional Requirements) FR-001: 多代理流程執行 需求描述: 系統應支援依序執行 N 個 AI 代理,每個代理的輸出自動成為下一個代理的輸入。
驗收標準:
能夠從 agents.yaml 載入任意數量代理配置 全流程執行按鈕可一次性串聯所有代理 每個代理執行狀態即時顯示於 UI (執行中/成功/失敗) 任一代理失敗時,流程中斷並記錄錯誤 優先級: P0 (必須)
追溯性: 需求來源 - FDA 510(k) 審查流程多階段特性
FR-002: 可編輯鏈式審查 需求描述: 使用者可在任意代理步驟編輯輸入或輸出,修改後的內容應成為後續步驟的預設輸入。
驗收標準:
每個代理顯示獨立的「輸入」與「輸出」文字區域 輸出支援「文字編輯」與「Markdown 預覽」雙模式切換 編輯輸出後,下一步代理的預設輸入即時更新 單步執行功能可使用當前編輯狀態執行指定代理 優先級: P0 (必須)
追溯性: 需求來源 - 人機協作審查模式需求
FR-003: 多 AI 提供商整合 需求描述: 系統應整合至少四家主流 AI 提供商,並支援動態模型選擇。
驗收標準:
支援 Google Gemini (≥2 個模型) 支援 OpenAI (≥2 個模型) 支援 Anthropic Claude (≥2 個模型) 支援 xAI Grok (≥2 個模型) 每個代理可獨立配置 provider/model/temperature/max_tokens API 金鑰支援環境變數與 UI 輸入雙管道 優先級: P0 (必須)
追溯性: 需求來源 - 模型多樣性與容錯需求
FR-004: AI 筆記助手 需求描述: 提供獨立的筆記轉換工具,支援非結構化文本的智慧化處理。
驗收標準:
結構化 Markdown 轉換 (清理、格式化、分段) 監管實體提取 (20 個關鍵實體 → 表格) Mermaid 心智圖生成 (hierarchical mindmap) 測驗題生成 (5 題 MCQs) 關鍵字高亮 (client-side,無需 AI 呼叫) 優先級: P1 (高度期望)
追溯性: 需求來源 - 會議筆記、測試報告等非結構化資料處理需求
FR-005: 互動式分析儀表板 需求描述: 追蹤並視覺化系統使用指標與執行歷史。
驗收標準:
顯示總執行次數、各提供商呼叫次數、最後執行時長 提供商使用分佈長條圖 執行日誌時間軸 (最近 30 筆) 日誌分類標記 (資訊/成功/錯誤) 以不同顏色區分 優先級: P2 (期望)
追溯性: 需求來源 - 系統可觀測性與使用行為分析
FR-006: 遊戲化激勵系統 需求描述: 透過健康值、魔力值、經驗值、成就徽章等元素提升使用參與度。
驗收標準:
健康值 (Health): 初始 100,固定值 (可擴展為壓力計) 魔力值 (Mana): 初始 100,每次代理執行消耗 20,不足時阻止執行 經驗值 (XP): 每次代理執行 +10,每 100 XP 升 1 級 成就徽章: 50 XP、200 XP、10 次執行等里程碑自動解鎖 魔力球 (Mana Orb): 動畫脈動視覺元件 壓力計 (Stress Meter): 與健康值反向關聯 (Stress = 100 - Health) 優先級: P2 (期望)
追溯性: 需求來源 - 使用者體驗與長時間審查疲勞緩解
FR-007: 多語言與主題支援 需求描述: 支援繁體中文與英文雙語切換,以及 20 種北歐花卉主題。
驗收標準:
語言切換: 英文 (en) / 繁體中文 (zh) 主題模式切換: 亮色 (light) / 暗色 (dark) 20 種花卉主題,每種包含 primary/secondary/accent/bg 四色配置 幸運抽獎按鈕隨機切換主題 主題切換即時套用至全局 CSS 優先級: P2 (期望)
追溯性: 需求來源 - 多地區使用者與審美偏好多樣性
3.2 非功能性需求 (Non-Functional Requirements) NFR-001: 效能需求 指標 目標值 測量方法 單代理執行回應時間 <30 秒 (95th percentile) API 呼叫計時器 全流程執行時間 (3 代理) <90 秒 (95th percentile) Pipeline orchestrator 計時 UI 載入時間 <3 秒 Streamlit metrics 並發使用者支援 ≥10 (單實例) 負載測試 NFR-002: 可用性需求 學習曲線: 新使用者應能在 15 分鐘內完成首次完整流程執行 錯誤訊息: 所有錯誤訊息應為繁體中文/英文雙語,並提供可操作建議 無障礙性: 遵循 WCAG 2.1 AA 級標準 (色彩對比、鍵盤導航) NFR-003: 可靠性需求 API 失敗容錯: 單一 AI 提供商故障時,使用者可切換至其他提供商繼續執行 會話持久性: 使用者會話資料在瀏覽器 refresh 後保持 (Streamlit session_state) 資料完整性: 所有代理輸出與執行日誌應完整保存於會話內 NFR-004: 安全性需求 詳見 第 8 節: 安全性考量
NFR-005: 可維護性需求 模組化設計: 每個功能模組 (Pipeline, Note Keeper, Dashboard) 應可獨立測試與部署 配置外部化: 代理配置、系統提示詞應存放於 agents.yaml 與 prompts.py,無需修改主程式 日誌記錄: 所有代理執行應記錄於 execution_log,包含時間戳、類型、訊息 NFR-006: 可擴展性需求 水平擴展: 支援 Kubernetes 部署,可透過增加 Pod 數量處理更高負載 模型擴展: 新增 AI 提供商僅需修改 AI_MODELS 字典與對應 call_* 函數 主題擴展: 新增花卉主題僅需於 FLOWER_THEMES 列表添加新項目 3.3 系統介面需求 3.3.1 使用者介面 (UI) 框架: Streamlit Web UI 瀏覽器相容性: Chrome/Edge/Firefox/Safari (最新兩版) RWD: 支援桌面瀏覽器,不保證行動裝置最佳化 (FDA 審查通常於桌面環境進行) 3.3.2 外部 API 介面 API 提供商 協定 認證方式 端點範例 Google Gemini REST API Key generativelanguage.googleapis.com OpenAI REST API Key api.openai.com/v1/chat/completions Anthropic REST API Key api.anthropic.com/v1/messages xAI Grok REST API Key api.x.ai/v1/chat (假設) 3.3.3 配置檔介面 agents.yaml 結構範例:
yaml
Copy agents:
id: "initial_review" name: "Initial 510(k) Reviewer" description: "Performs preliminary device classification and predicate identification" provider: "gemini" model: "gemini-2.5-flash" max_tokens: 4000 temperature: 0.2 system_prompt: | You are an FDA 510(k) pre-market reviewer specializing in initial device assessment. Analyze the provided device description and output:
Device classification (Class I/II/III)
Product code and regulation number
Potential predicate devices
Key regulatory concerns Output in structured Markdown.
id: "risk_analysis" name: "Risk Analyzer" description: "Evaluates biocompatibility, electrical safety, and software risks" provider: "openai" model: "gpt-4o-mini" max_tokens: 3000 temperature: 0.3 system_prompt: | 你是醫療器材風險管理專家,依據 ISO 14971 與 FDA 指引進行風險分析。 輸入為前一步驟的裝置描述,請輸出:
已識別危害清單 (≥10 項)
風險等級評估 (嚴重性 × 發生機率)
風險控制措施建議
殘餘風險評估 以繁體中文 Markdown 表格與條列式呈現。
系統需求 4.1 硬體需求 4.1.1 開發環境 元件 最低配置 建議配置 CPU 2 核心 4 核心+ RAM 4 GB 8 GB+ 硬碟 10 GB 可用空間 20 GB SSD 網路 穩定寬頻連線 ≥10 Mbps 4.1.2 生產環境 (單實例) 元件 最低配置 建議配置 CPU 2 vCPU 4 vCPU RAM 4 GB 8 GB 硬碟 20 GB 50 GB SSD 網路 穩定公網連線 ≥100 Mbps 4.1.3 生產環境 (Kubernetes 叢集) 節點數量: 3+ (高可用性) 每節點配置: 4 vCPU, 16 GB RAM 持久化儲存: 支援 ReadWriteMany 的 PV (若需共享配置檔) 4.2 軟體需求 4.2.1 作業系統 開發: Windows 10+, macOS 11+, Ubuntu 20.04+ 生產: Ubuntu 20.04/22.04 LTS, Amazon Linux 2, RHEL 8+ 4.2.2 Python 環境 版本: Python 3.9 - 3.11 (建議 3.10) 套件管理: pip 21.0+, 建議使用 virtual environment 4.2.3 必要 Python 套件 txt
Copy streamlit>=1.30.0 pyyaml>=6.0 google-generativeai>=0.3.0 openai>=1.0.0 anthropic>=0.8.0 xai-sdk>=0.1.0 # 假設版本 4.2.4 容器環境 (選用) Docker: 20.10+ 基礎映像: python:3.10-slim 4.2.5 Orchestration (選用) Kubernetes: 1.24+ Helm: 3.10+ (若使用 Helm Chart) 4.3 網路需求 對外連線: 需存取以下網域 (防火牆白名單) generativelanguage.googleapis.com (Gemini) api.openai.com (OpenAI) api.anthropic.com (Anthropic) api.x.ai (xAI) 對內連線: 若多實例部署,需開放容器間通訊 (K8s Service mesh) 5. 環境設定 5.1 本地開發環境設定 步驟 1: 安裝 Python bash
Copy
Ubuntu/Debian
sudo apt update sudo apt install python3.10 python3.10-venv python3-pip
macOS (Homebrew)
brew install python@3.10
Windows (透過 python.org 下載安裝器)
步驟 2: 建立虛擬環境 bash
Copy python3.10 -m venv venv source venv/bin/activate # Linux/macOS venv\Scripts\activate # Windows 步驟 3: 安裝依賴套件 bash
Copy pip install --upgrade pip pip install -r requirements.txt 步驟 4: 配置環境變數 建立 .env 檔案 (不應提交至 Git):
bash
Copy
.env
GEMINI_API_KEY=AIzaSy... OPENAI_API_KEY=sk-... ANTHROPIC_API_KEY=sk-ant-... XAI_API_KEY=xai-... 載入環境變數:
bash
Copy
Linux/macOS
export $(cat .env | xargs)
Windows (PowerShell)
Get-Content .env | ForEach-Object { $_.Split('=') | Set-Variable } 步驟 5: 準備配置檔 建立 agents.yaml (參考 3.3.3 節)
步驟 6: 啟動應用 bash
Copy streamlit run app.py --server.port 8501 瀏覽器開啟 http://localhost:8501
5.2 Docker 環境設定 Dockerfile dockerfile
Copy FROM python:3.10-slim
WORKDIR /app
安裝系統依賴 (若需要)
RUN apt-get update && apt-get install -y --no-install-recommends
build-essential
&& rm -rf /var/lib/apt/lists/*
複製依賴清單並安裝
COPY requirements.txt . RUN pip install --no-cache-dir -r requirements.txt
複製應用程式碼
COPY app.py prompts.py agents.yaml ./
暴露 Streamlit 預設埠
EXPOSE 8501
健康檢查
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3
CMD curl --fail http://localhost:8501/_stcore/health || exit 1
啟動指令
CMD ["streamlit", "run", "app.py", "--server.port=8501", "--server.address=0.0.0.0"] 建置與執行 bash
Copy
建置映像
docker build -t fda-review-studio:v2 .
執行容器
docker run -d
--name fda-studio
-p 8501:8501
-e GEMINI_API_KEY=
OPENAI_API_KEY
-e ANTHROPIC_API_KEY=
XAI_API_KEY
fda-review-studio:v2
檢視日誌
docker logs -f fda-studio 6. 部署選項 6.1 本地部署 (Local Deployment) 適用場景: 個人開發測試、隔離環境審查
步驟:
依照 5.1 節 完成環境設定 執行 streamlit run app.py 透過 http://localhost:8501 存取 優點:
完全離線 (若 API 金鑰預先設定) 最快速部署 無雲端成本 缺點:
無法多人協作 單點故障 無自動擴展 6.2 AWS 部署選項 6.2.1 AWS EC2 部署 架構圖:
Copy Internet → ELB → EC2 Instance (Streamlit) → AI APIs ↓ EBS Volume (配置檔) 步驟:
啟動 EC2 執行個體: AMI: Ubuntu 22.04 LTS 執行個體類型: t3.medium (2 vCPU, 4 GB RAM) 安全群組: 允許 443 (HTTPS), 22 (SSH) IAM 角色: 若需存取 Secrets Manager 儲存 API 金鑰 安裝應用: bash
Copy ssh -i keypair.pem ubuntu@ <EC2_PUBLIC_IP> sudo apt update && sudo apt install python3.10-venv nginx -y git clone <REPO_URL> cd fda-review-studio python3 -m venv venv source venv/bin/activate pip install -r requirements.txt 配置 systemd 服務: ini
Copy
/etc/systemd/system/fda-studio.service
[Unit] Description=FDA Review Studio After=network.target
[Service] Type=simple User=ubuntu WorkingDirectory=/home/ubuntu/fda-review-studio Environment="PATH=/home/ubuntu/fda-review-studio/venv/bin" EnvironmentFile=/home/ubuntu/fda-review-studio/.env ExecStart=/home/ubuntu/fda-review-studio/venv/bin/streamlit run app.py --server.port 8501 Restart=always
[Install] WantedBy=multi-user.target 啟動服務: bash
Copy sudo systemctl daemon-reload sudo systemctl enable fda-studio sudo systemctl start fda-studio 配置 Nginx 反向代理 (HTTPS): nginx
Copy server { listen 443 ssl; server_name fda-review.example.com;
ssl_certificate /etc/letsencrypt/live/fda-review.example.com/fullchain.pem;
ssl_certificate_key /etc/letsencrypt/live/fda-review.example.com/privkey.pem;
location / {
proxy_pass http://localhost:8501;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection "upgrade";
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
}
} 成本估算 (us-east-1):
t3.medium: $0.0416/hr × 730 hrs = $30.37/月 EBS (30 GB): $3/月 ELB (Application): 
5/月 總計: ~$55/月 6.2.2 AWS ECS Fargate 部署 架構圖:
Copy Internet → ALB → ECS Service (Fargate Tasks) → AI APIs ↓ EFS (共享配置檔) ↓ Secrets Manager (API Keys) 步驟:
建立 ECR 儲存庫: bash
Copy aws ecr create-repository --repository-name fda-review-studio docker tag fda-review-studio:v2 <AWS_ACCOUNT>.dkr.ecr.us-east-1.amazonaws.com/fda-review-studio:v2 docker push <AWS_ACCOUNT>.dkr.ecr.us-east-1.amazonaws.com/fda-review-studio:v2 建立 ECS Task Definition (JSON): json
Copy { "family": "fda-studio-task", "networkMode": "awsvpc", "requiresCompatibilities": ["FARGATE"], "cpu": "1024", "memory": "2048", "containerDefinitions": [ { "name": "fda-studio", "image": "<ECR_IMAGE_URI>", "portMappings": [{"containerPort": 8501}], "secrets": [ {"name": "GEMINI_API_KEY", "valueFrom": "arn:aws:secretsmanager:us-east-1:xxx:secret:fda/gemini"}, {"name": "OPENAI_API_KEY", "valueFrom": "arn:aws:secretsmanager:us-east-1:xxx:secret:fda/openai"} ], "logConfiguration": { "logDriver": "awslogs", "options": { "awslogs-group": "/ecs/fda-studio", "awslogs-region": "us-east-1", "awslogs-stream-prefix": "ecs" } } } ] } 建立 ECS Service: bash
Copy aws ecs create-service
--cluster fda-cluster
--service-name fda-studio-service
--task-definition fda-studio-task
--desired-count 2
--launch-type FARGATE
--network-configuration "awsvpcConfiguration={subnets=[subnet-xxx],securityGroups=[sg-xxx],assignPublicIp=ENABLED}"
--load-balancers "targetGroupArn=arn:aws:elasticloadbalancing:us-east-1:xxx:targetgroup/fda-tg,containerName=fda-studio,containerPort=8501" 自動擴展配置:
bash
Copy aws application-autoscaling register-scalable-target
--service-namespace ecs
--scalable-dimension ecs:service:DesiredCount
--resource-id service/fda-cluster/fda-studio-service
--min-capacity 2
--max-capacity 10
aws application-autoscaling put-scaling-policy
--policy-name fda-cpu-scaling
--service-namespace ecs
--scalable-dimension ecs:service:DesiredCount
--resource-id service/fda-cluster/fda-studio-service
--policy-type TargetTrackingScaling
--target-tracking-scaling-policy-configuration file://scaling-policy.json 成本估算:
Fargate (1 vCPU, 2GB) × 2 tasks: $0.04048/hr × 2 × 730 = $59.10/月 ALB: $16.20/月 NAT Gateway (若使用私有子網): 
108/月 6.2.3 AWS Lambda + API Gateway 部署 (實驗性) 限制: Streamlit 本身不適合 Lambda,但可將核心邏輯 (run_agent) 包裝成 Lambda 函數,前端改用靜態 S3 + API Gateway。
不建議原因:
Streamlit 狀態管理依賴長連線 WebSocket Lambda 15 分鐘執行時限可能不足 (多代理流程) 冷啟動延遲影響使用者體驗 6.3 GCP 部署選項 6.3.1 GCP Compute Engine 部署 類似 AWS EC2,使用 e2-medium 執行個體,步驟略。
成本估算:
e2-medium (us-central1): $24.27/月 Persistent Disk (30 GB): $2.04/月 Load Balancer: 
45/月 6.3.2 GCP Cloud Run 部署 優勢: 完全託管、自動擴展、按請求計費
步驟:
建置容器並推送至 GCR: bash
Copy gcloud builds submit --tag gcr.io/PROJECT_ID/fda-review-studio 部署至 Cloud Run: bash
Copy gcloud run deploy fda-studio
--image gcr.io/PROJECT_ID/fda-review-studio
--platform managed
--region us-central1
--allow-unauthenticated
--memory 2Gi
--cpu 2
--timeout 3600
--set-env-vars GEMINI_API_KEY=xxx,OPENAI_API_KEY=xxx
--max-instances 10 配置自訂網域: bash
Copy gcloud run domain-mappings create --service fda-studio --domain fda-review.example.com 成本估算 (低流量場景):
請求費用: $0.40 per million requests CPU: $0.00002400 per vCPU-second Memory: 
15/月 6.3.3 GCP GKE 部署 類似 AWS EKS,使用 Kubernetes Deployment + Service,步驟略。
成本估算:
GKE 叢集管理費: $0.10/hr × 730 = $73/月 3 × e2-standard-4 節點: $122.18/月 × 3 = 
440/月 (適合企業級高流量場景) 6.4 Azure 部署選項 6.4.1 Azure App Service 部署 步驟:
建立 App Service Plan: bash
Copy az appservice plan create
--name fda-plan
--resource-group fda-rg
--sku B2
--is-linux 建立 Web App: bash
Copy az webapp create
--name fda-review-studio
--resource-group fda-rg
--plan fda-plan
--runtime "PYTHON:3.10" 配置環境變數: bash
Copy az webapp config appsettings set
--name fda-review-studio
--resource-group fda-rg
--settings GEMINI_API_KEY=xxx OPENAI_API_KEY=xxx 部署程式碼 (透過 ZIP): bash
Copy zip -r app.zip app.py agents.yaml prompts.py requirements.txt az webapp deployment source config-zip
--name fda-review-studio
--resource-group fda-rg
--src app.zip 成本估算:
B2 (2 核心, 3.5 GB RAM): 
5/月 總計: ~$78/月 6.4.2 Azure Container Instances (ACI) 快速部署 (適合測試):
bash
Copy az container create
--name fda-studio
--resource-group fda-rg
--image <ACR_IMAGE_URI>
--cpu 2
--memory 4
--ports 8501
--environment-variables GEMINI_API_KEY=xxx OPENAI_API_KEY=xxx
--dns-name-label fda-review 成本: ~$45/月 (2 vCPU, 4 GB RAM, 持續執行)
6.4.3 Azure Kubernetes Service (AKS) 類似 AWS EKS / GCP GKE,步驟略。
成本估算:
3 × Standard_D2s_v3 節點: $96.36/月 × 3 = $289.08/月 Load Balancer: 
307/月 6.5 混合部署 (Hybrid Deployment) 場景: 敏感資料需留在內部機房,但希望使用雲端 AI 服務
架構:
Copy [內部機房] ↓ 企業防火牆 (Outbound HTTPS 允許 AI API 網域) ↓ [雲端 AI 提供商] 實施步驟:
內部 VM/容器部署: 依照 6.1 節 於企業資料中心部署 網路設定: 配置防火牆允許存取 api.openai.com, generativelanguage.googleapis.com 等 VPN/Direct Connect (選用): 若需存取雲端託管的配置檔或日誌儲存 (如 S3) Identity Federation: 使用企業 SSO (SAML/OAuth) 整合使用者驗證 優點:
資料不出內部網路 符合 HIPAA/GDPR 等合規要求 缺點:
需自行維護基礎設施 網路延遲可能較高 6.6 部署建議矩陣 場景 建議部署方案 原因 個人/小團隊測試 本地 or GCP Cloud Run 成本低、部署快 企業 POC (10-50 用戶) AWS ECS Fargate 易管理、自動擴展 生產環境 (100+ 用戶) AWS/GCP/Azure Kubernetes 高可用性、可觀測性 高度監管環境 混合部署 (內部 VM) 資料主權、合規性 無固定流量 GCP Cloud Run 按需計費、零閒置成本 7. 基礎設施即程式碼 (IaC) 與整合 7.1 Terraform 範例 (AWS ECS Fargate) hcl
Copy
main.tf
terraform { required_version = ">= 1.3" required_providers { aws = { source = "hashicorp/aws" version = "~> 5.0" } } }
provider "aws" { region = var.aws_region }
VPC
resource "aws_vpc" "fda_vpc" { cidr_block = "10.0.0.0/16" tags = { Name = "fda-vpc" } }
Subnets (公有 × 2)
resource "aws_subnet" "public_subnet_a" { vpc_id = aws_vpc.fda_vpc.id cidr_block = "10.0.1.0/24" availability_zone = "${var.aws_region}a" map_public_ip_on_launch = true }
resource "aws_subnet" "public_subnet_b" { vpc_id = aws_vpc.fda_vpc.id cidr_block = "10.0.2.0/24" availability_zone = "${var.aws_region}b" map_public_ip_on_launch = true }
Internet Gateway
resource "aws_internet_gateway" "igw" { vpc_id = aws_vpc.fda_vpc.id }
Route Table
resource "aws_route_table" "public_rt" { vpc_id = aws_vpc.fda_vpc.id route { cidr_block = "0.0.0.0/0" gateway_id = aws_internet_gateway.igw.id } }
resource "aws_route_table_association" "public_rta_a" { subnet_id = aws_subnet.public_subnet_a.id route_table_id = aws_route_table.public_rt.id }
resource "aws_route_table_association" "public_rta_b" { subnet_id = aws_subnet.public_subnet_b.id route_table_id = aws_route_table.public_rt.id }
Security Group
resource "aws_security_group" "ecs_sg" { vpc_id = aws_vpc.fda_vpc.id
ingress { from_port = 8501 to_port = 8501 protocol = "tcp" cidr_blocks = ["0.0.0.0/0"] }
egress { from_port = 0 to_port = 0 protocol = "-1" cidr_blocks = ["0.0.0.0/0"] } }
ECS Cluster
resource "aws_ecs_cluster" "fda_cluster" { name = "fda-cluster" }
Task Definition
resource "aws_ecs_task_definition" "fda_task" { family = "fda-studio-task" network_mode = "awsvpc" requires_compatibilities = ["FARGATE"] cpu = "1024" memory = "2048" execution_role_arn = aws_iam_role.ecs_execution_role.arn
container_definitions = jsonencode([{ name = "fda-studio" image = var.ecr_image_uri portMappings = [{ containerPort = 8501 protocol = "tcp" }] secrets = [ { name = "GEMINI_API_KEY", valueFrom = aws_secretsmanager_secret.gemini.arn }, { name = "OPENAI_API_KEY", valueFrom = aws_secretsmanager_secret.openai.arn } ] logConfiguration = { logDriver = "awslogs" options = { "awslogs-group" = "/ecs/fda-studio" "awslogs-region" = var.aws_region "awslogs-stream-prefix" = "ecs" } } }]) }
ECS Service
resource "aws_ecs_service" "fda_service" { name = "fda-studio-service" cluster = aws_ecs_cluster.fda_cluster.id task_definition = aws_ecs_task_definition.fda_task.arn desired_count = 2 launch_type = "FARGATE"
network_configuration { subnets = [aws_subnet.public_subnet_a.id, aws_subnet.public_subnet_b.id] security_groups = [aws_security_group.ecs_sg.id] assign_public_ip = true }
load_balancer { target_group_arn = aws_lb_target_group.fda_tg.arn container_name = "fda-studio" container_port = 8501 } }
Application Load Balancer
resource "aws_lb" "fda_alb" { name = "fda-alb" internal = false load_balancer_type = "application" security_groups = [aws_security_group.ecs_sg.id] subnets = [aws_subnet.public_subnet_a.id, aws_subnet.public_subnet_b.id] }
resource "aws_lb_target_group" "fda_tg" { name = "fda-tg" port = 8501 protocol = "HTTP" vpc_id = aws_vpc.fda_vpc.id target_type = "ip"
health_check { path = "/_stcore/health" interval = 30 timeout = 10 healthy_threshold = 2 unhealthy_threshold = 3 } }
resource "aws_lb_listener" "fda_listener" { load_balancer_arn = aws_lb.fda_alb.arn port = "80" protocol = "HTTP"
default_action { type = "forward" target_group_arn = aws_lb_target_group.fda_tg.arn } }
IAM Role for ECS Execution
resource "aws_iam_role" "ecs_execution_role" { name = "fda-ecs-execution-role"
assume_role_policy = jsonencode({ Version = "2012-10-17" Statement = [{ Action = "sts:AssumeRole" Effect = "Allow" Principal = { Service = "ecs-tasks.amazonaws.com" } }] }) }
resource "aws_iam_role_policy_attachment" "ecs_execution_policy" { role = aws_iam_role.ecs_execution_role.name policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy" }
Secrets Manager
resource "aws_secretsmanager_secret" "gemini" { name = "fda/gemini-api-key" }
resource "aws_secretsmanager_secret" "openai" { name = "fda/openai-api-key" }
輸出
output "alb_dns_name" { value = aws_lb.fda_alb.dns_name } 部署指令:
bash
Copy terraform init terraform plan -var="aws_region=us-east-1" -var="ecr_image_uri=xxx" terraform apply 7.2 Kubernetes Deployment YAML yaml
Copy
k8s-deployment.yaml
apiVersion: v1 kind: Namespace metadata: name: fda-studio
apiVersion: v1 kind: Secret metadata: name: ai-api-keys namespace: fda-studio type: Opaque data: gemini-key: <BASE64_ENCODED> openai-key: <BASE64_ENCODED> anthropic-key: <BASE64_ENCODED> xai-key: <BASE64_ENCODED>
apiVersion: v1 kind: ConfigMap metadata: name: agents-config namespace: fda-studio data: agents.yaml: | agents: - id: "initial_review" name: "Initial Reviewer" provider: "gemini" model: "gemini-2.5-flash" max_tokens: 4000 temperature: 0.2 system_prompt: "..."
apiVersion: apps/v1 kind: Deployment metadata: name: fda-studio-deployment namespace: fda-studio spec: replicas: 3 selector: matchLabels: app: fda-studio template: metadata: labels: app: fda-studio spec: containers: - name: fda-studio image: gcr.io/PROJECT_ID/fda-review-studio:v2 ports: - containerPort: 8501 env: - name: GEMINI_API_KEY valueFrom: secretKeyRef: name: ai-api-keys key: gemini-key - name: OPENAI_API_KEY valueFrom: secretKeyRef: name: ai-api-keys key: openai-key volumeMounts: - name: config-volume mountPath: /app/agents.yaml subPath: agents.yaml resources: requests: memory: "2Gi" cpu: "1000m" limits: memory: "4Gi" cpu: "2000m" livenessProbe: httpGet: path: /_stcore/health port: 8501 initialDelaySeconds: 30 periodSeconds: 10 readinessProbe: httpGet: path: /_stcore/health port: 8501 initialDelaySeconds: 10 periodSeconds: 5 volumes: - name: config-volume configMap: name: agents-config
apiVersion: v1 kind: Service metadata: name: fda-studio-service namespace: fda-studio spec: type: LoadBalancer selector: app: fda-studio ports:
protocol: TCP port: 80 targetPort: 8501
apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata: name: fda-studio-hpa namespace: fda-studio spec: scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: fda-studio-deployment minReplicas: 2 maxReplicas: 10 metrics:
type: Resource resource: name: cpu target: type: Utilization averageUtilization: 70 部署指令:
bash
Copy kubectl apply -f k8s-deployment.yaml kubectl get svc -n fda-studio # 取得 Load Balancer IP 7.3 CI/CD 整合 (GitHub Actions) yaml
Copy
.github/workflows/deploy.yml
name: Build and Deploy
on: push: branches: [main]
env: GCP_PROJECT_ID: ${{ secrets.GCP_PROJECT_ID }} GCP_REGION: us-central1 SERVICE_NAME: fda-studio
jobs: build-and-deploy: runs-on: ubuntu-latest
steps:
name: Checkout code
uses: actions/checkout@v3
name: Authenticate to Google Cloud
uses: google-github-actions/auth@v1
with:
credentials_json: ${{ secrets.GCP_SA_KEY }}
name: Set up Cloud SDK
uses: google-github-actions/setup-gcloud@v1
name: Build and push Docker image
run: |
gcloud builds submit --tag gcr.io/
SERVICE_NAME:
GCP_PROJECT_ID/$SERVICE_NAME:latest
name: Deploy to Cloud Run
run: |
gcloud run deploy 
GCP_PROJECT_ID/
GITHUB_SHA
--platform managed
--region $GCP_REGION
--allow-unauthenticated
--memory 2Gi
--cpu 2
--timeout 3600
--set-secrets GEMINI_API_KEY=gemini-key:latest,OPENAI_API_KEY=openai-key:latest
name: Run integration tests
run: |
SERVICE_URL=$(gcloud run services describe $SERVICE_NAME --region $GCP_REGION --format 'value(status.url)')
curl -f $SERVICE_URL/_stcore/health || exit 1
安全性考量 8.1 威脅模型 (STRIDE) 威脅類型 潛在攻擊 緩解措施 Spoofing (身份偽裝) 未授權使用者冒充合法審查員 實施 OAuth 2.0 / SAML SSO,整合企業 AD Tampering (資料竄改) 惡意修改代理輸出或配置檔 agents.yaml 檔案權限限制為唯讀,輸出加密儲存 Repudiation (否認性) 使用者否認執行過某審查操作 完整審計日誌 (包含使用者 ID、時間戳、操作內容) Information Disclosure (資訊洩漏) API 金鑰外洩、敏感案例資料洩漏 環境變數 + Secrets Manager,傳輸層 TLS 1.3 Denial of Service (阻斷服務) 惡意大量請求耗盡 Mana/資源 Rate limiting (per-user),Auto-scaling Elevation of Privilege (權限提升) 一般使用者取得管理員權限 RBAC,最小權限原則 8.2 API 金鑰管理最佳實踐 8.2.1 環境變數 (開發/測試) bash
Copy
.env (絕不提交至 Git)
GEMINI_API_KEY=AIzaSy... OPENAI_API_KEY=sk-proj-... ANTHROPIC_API_KEY=sk-ant-api03-... XAI_API_KEY=xai-... Git 保護:
bash
Copy
.gitignore
.env *.env secrets/ 8.2.2 雲端 Secrets Manager (生產環境) AWS Secrets Manager:
bash
Copy aws secretsmanager create-secret
--name fda/gemini-api-key
--secret-string "AIzaSy..."
ECS Task Definition 引用
"secrets": [ { "name": "GEMINI_API_KEY", "valueFrom": "arn:aws:secretsmanager:us-east-1:xxx:secret:fda/gemini-api-key" } ] GCP Secret Manager:
bash
Copy echo -n "AIzaSy..." | gcloud secrets create gemini-key --data-file=-
Cloud Run 部署時引用
gcloud run deploy fda-studio
--set-secrets GEMINI_API_KEY=gemini-key:latest Azure Key Vault:
bash
Copy az keyvault secret set
--vault-name fda-keyvault
--name gemini-api-key
--value "AIzaSy..."
App Service 引用
az webapp config appsettings set
--name fda-studio
--settings GEMINI_API_KEY=@Microsoft.KeyVault(SecretUri=https://fda-keyvault.vault.azure.net/secrets/gemini-api-key/) 8.2.3 金鑰輪替策略 輪替週期: 每 90 天 自動化: 使用 AWS Secrets Manager Rotation Lambda 多版本: 保留前一版本金鑰 24 小時,確保無服務中斷 8.3 資料隱私保護 8.3.1 PII (個人身份資訊) 處理 匿名化: 所有案例描述在發送至 AI 前,自動替換患者姓名、醫療記錄號碼等 PII python
Copy import re def anonymize_text(text): text = re.sub(r'\b[A-Z][a-z]+ [A-Z][a-z]+\b', '[PATIENT_NAME]', text) text = re.sub(r'\b\d{6,10}\b', '[MRN]', text) return text 資料留存: 不儲存任何案例資料於後端,僅保存於使用者瀏覽器 Session (Streamlit session_state) 合規性: 符合 HIPAA Privacy Rule (若處理美國健康資料) 8.3.2 傳輸層安全 TLS 1.3: 所有對外通訊 (瀏覽器 ↔ 伺服器、伺服器 ↔ AI APIs) 強制使用 TLS 1.3 憑證管理: 使用 Let's Encrypt 自動更新 SSL 憑證 (Certbot) HSTS: 啟用 HTTP Strict Transport Security header nginx
Copy add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always; 8.4 應用程式安全 8.4.1 輸入驗證 python
Copy def validate_input(text: str) -> bool: if len(text) > 100000: # 防止超大輸入導致 DoS raise ValueError("輸入文字超過 100,000 字元限制") if re.search(r'<script|javascript:|onerror=', text, re.IGNORECASE): raise ValueError("偵測到潛在 XSS 攻擊向量") return True 8.4.2 輸出編碼 Markdown 渲染: Streamlit 預設會 sanitize HTML,但需防範 Markdown injection 日誌輸出: 避免記錄未編碼的使用者輸入,防止 Log Injection 8.4.3 依賴套件掃描 bash
Copy
使用 pip-audit 掃描已知漏洞
pip install pip-audit pip-audit
使用 Safety 檢查
safety check --file requirements.txt 自動化: 於 CI/CD pipeline 整合 Snyk 或 Dependabot
8.5 存取控制 8.5.1 驗證機制 (Authentication) 選項 1: OAuth 2.0 (Google Workspace)
python
Copy import streamlit_authenticator as stauth
authenticator = stauth.Authenticate( names=['審查員A', '審查員B'], usernames=['reviewer_a', 'reviewer_b'], passwords=[...], # 雜湊後密碼 cookie_name='fda_studio_auth', key='random_signature_key', cookie_expiry_days=1 )
name, authentication_status, username = authenticator.login('Login', 'main')
if authentication_status: st.write(f'歡迎 {name}') # 主應用程式邏輯 elif authentication_status == False: st.error('使用者名稱或密碼錯誤') 選項 2: SAML SSO (企業級)
使用 AWS Cognito / Azure AD / Okta 作為 Identity Provider Streamlit 前方部署 Nginx + auth_request 模組,轉發至 IDP 8.5.2 授權機制 (Authorization) 角色定義:
角色 權限 Reviewer (審查員) 執行 Pipeline、Note Keeper,查看 Dashboard Admin (管理員) 所有審查員權限 + 編輯 agents.yaml、查看所有使用者日誌 Auditor (稽核員) 唯讀存取 Dashboard 與執行日誌 實作範例:
python
Copy if st.session_state.user_role == 'admin': st.sidebar.button("編輯代理配置") elif st.session_state.user_role == 'auditor': st.info("您的角色僅可查看資料,無法執行審查") 8.6 審計日誌 8.6.1 日誌欄位 欄位 說明 範例 timestamp ISO 8601 時間戳 2024-01-15T14:23 .123Z user_id 使用者唯一識別碼 reviewer_a@fda.gov action 操作類型 pipeline_run / note_transform / config_edit agent_id 涉及代理 ID initial_review provider AI 提供商 gemini model 模型名稱 gemini-2.5-flash input_hash 輸入文字 SHA-256 a3b2c1... output_hash 輸出文字 SHA-256 d4e5f6... status 執行狀態 success / error error_msg 錯誤訊息 (若失敗) API key invalid duration_ms 執行時長 (毫秒) 12345 8.6.2 日誌儲存 本地檔案 (開發):
python
Copy import logging
logging.basicConfig( filename='fda_audit.log', level=logging.INFO, format='%(asctime)s | %(levelname)s | %(message)s' )
logging.info(f"user={user_id} | action=pipeline_run | agent={agent.id} | status=success") 雲端日誌服務 (生產):
AWS CloudWatch Logs: ECS Task 自動轉發至 /ecs/fda-studio log group GCP Cloud Logging: Cloud Run 自動整合 Azure Monitor Logs: App Service 診斷設定啟用 SIEM 整合: 透過 Fluentd/Logstash 轉發至 Splunk/ELK
8.7 安全開發生命週期 (SDL) mermaid
Copy graph LR A[需求階段] --> B[設計階段] B --> C[開發階段] C --> D[測試階段] D --> E[部署階段] E --> F[維運階段]
A -->|威脅模型| TM[STRIDE 分析]
B -->|安全架構審查| SAR[Security Architecture Review]
C -->|靜態程式碼掃描| SAST[Bandit / SonarQube]
D -->|滲透測試| PT[OWASP ZAP]
E -->|配置掃描| CS[Trivy / Checkov]
F -->|漏洞監控| VM[Snyk / Dependabot]
驗證計畫 9.1 驗證目標 依據 FDA 21 CFR Part 11 (電子記錄/電子簽章) 與 ISO 13485 (醫療器材品質管理系統) 精神,本驗證計畫確保系統:
功能符合 SRS 規格 輸出結果可重現 資料完整性與可追溯性 安全性控制有效運作 9.2 驗證層級
Copy V 模型: 需求 (SRS) ←→ 驗收測試 (UAT) ↓ ↑ 設計 ←→ 系統整合測試 (SIT) ↓ ↑ 編碼 ←→ 單元測試 (UT) 9.3 單元測試 (Unit Testing) 9.3.1 測試框架 bash
Copy pip install pytest pytest-cov 9.3.2 測試案例範例 python
Copy
tests/test_agent_execution.py
import pytest from unittest.mock import patch, MagicMock from app import run_agent, AgentConfig
def test_run_agent_gemini_success(): """測試 Gemini 代理正常執行""" agent = AgentConfig( id="test_agent", name="Test Agent", description="", model="gemini-2.5-flash", max_tokens=1000, temperature=0.2, system_prompt="You are a test assistant.", provider="gemini" )
with patch('app.call_gemini', return_value="Test output"):
result = run_agent(agent, "Test input")
assert result == "Test output"
assert agent.provider == "gemini"
def test_run_agent_api_key_missing(): """測試缺少 API 金鑰時拋出異常""" agent = AgentConfig( id="test_agent", name="Test Agent", description="", model="gpt-4o-mini", max_tokens=1000, temperature=0.2, system_prompt="", provider="openai" )
with patch('app.get_api_key', return_value=None):
with pytest.raises(RuntimeError, match="No API key configured"):
run_agent(agent, "Test input")
def test_anonymize_pii(): """測試 PII 匿名化功能""" from app import anonymize_text # 假設已實作
input_text = "Patient John Doe with MRN 123456789 underwent surgery."
expected = "Patient [PATIENT_NAME] with MRN [MRN] underwent surgery."
result = anonymize_text(input_text)
assert result == expected
9.3.3 覆蓋率要求 目標: 程式碼覆蓋率 ≥80% 執行: bash
Copy pytest --cov=app --cov-report=html open htmlcov/index.html 9.4 整合測試 (Integration Testing) 9.4.1 測試情境 測試案例 ID 情境描述 預期結果 優先級 IT-001 完整 3 代理流程執行 所有代理成功執行,輸出連續傳遞 P0 IT-002 代理 2 失敗時流程中斷 Pipeline 停止,錯誤訊息記錄 P0 IT-003 編輯代理 1 輸出後重新執行代理 2 代理 2 使用新輸入,輸出更新 P0 IT-004 Note Keeper Markdown 轉換 非結構化文字轉為標準 Markdown P1 IT-005 Dashboard 指標更新 執行後 total_runs +1, provider_calls 正確增量 P2 9.4.2 測試腳本範例 (IT-001) python
Copy
tests/test_integration.py
import streamlit as st from app import init_session_state, run_agent, AgentConfig
def test_full_pipeline_execution(): """測試完整 3 代理流程""" init_session_state()
模擬 3 個代理
agents = [
AgentConfig("a1", "Agent 1", "", "gemini-2.5-flash", 1000, 0.2, "Prompt 1", "gemini"),
AgentConfig("a2", "Agent 2", "", "gpt-4o-mini", 1000, 0.3, "Prompt 2", "openai"),
AgentConfig("a3", "Agent 3", "", "claude-3-5-haiku-20241022", 1000, 0.2, "Prompt 3", "anthropic"),
]
模擬 API 呼叫
with patch('app.call_gemini', return_value="A1 Output"),
patch('app.call_openai', return_value="A2 Output"),
patch('app.call_anthropic', return_value="A3 Output"):
code
Code
input_text = "Initial case description"

# 執行 Agent 1
result1 = run_agent(agents[0], input_text)
assert result1 == "A1 Output"

# 執行 Agent 2 (使用 A1 輸出)
result2 = run_agent(agents[1], result1)
assert result2 == "A2 Output"

# 執行 Agent 3 (使用 A2 輸出)
result3 = run_agent(agents[2], result2)
assert result3 == "A3 Output"
驗證指標
assert st.session_state.metrics["total_runs"] == 3
assert st.session_state.metrics["provider_calls"]["gemini"] == 1
assert st.session_state.metrics["provider_calls"]["openai"] == 1
assert st.session_state.metrics["provider_calls"]["anthropic"] == 1
9.5 系統測試 (System Testing) 9.5.1 功能性測試 測試案例 ID 需求 ID 測試步驟 預期結果 ST-FR-001 FR-001 1. 載入 agents.yaml
2. 點擊「Run Full Pipeline」 所有代理依序執行,狀態燈顯示「成功」 ST-FR-002 FR-002 1. 執行代理 1
2. 編輯輸出
3. 點擊「Run only step 2」 代理 2 使用編輯後輸入,輸出更新 ST-FR-003 FR-003 1. 於代理 1 配置選擇 provider=OpenAI
2. 執行 成功呼叫 OpenAI API,返回有效輸出 ST-FR-004 FR-004 1. 於 Note Keeper 輸入非結構化文字
2. 選擇「實體提取」
3. 執行 輸出包含 20 個實體的 Markdown 表格 Max tokens to sample reached
Gemini 3 Pro Preview
Ran for 86s
lightbulb
Thought for 86 seconds
這是一份針對 TFDA 醫療器材查驗登記電子化送件系統導入智慧化審查 的完整可行性方案技術規格書。內容基於前述的使用者調查結果（特別是針對檢索速度、介面痛點與 AI 需求），並參考了您提供的 FDA 510(k) 技術規格格式進行撰寫。
關鍵字已使用 <span style="color: coral">珊瑚色 (coral)</span> 標記。
醫療器材查驗登記電子化送件系統導入智慧化審查之可行性方案 (TFDA Smart Review Initiative)
文件版本控制
版本	日期	作者	變更說明
1.0	2024-05-XX	系統架構師	初始版本：基於使用者調查報告之需求分析與可行性評估
目錄
執行摘要 (Executive Summary)
現況痛點與需求對應 (Gap Analysis)
系統架構 (System Architecture)
軟體需求規格 (SRS)
AI 模型策略與選型 (AI Strategy)
安全性與合規性考量 (Security & Compliance)
基礎設施與部署方案 (Infrastructure & Deployment)
驗證與測試計畫 (Validation Plan)
實施路徑與預算評估 (Roadmap)
附錄：關鍵風險評估
1. 執行摘要 (Executive Summary)
1.1 計畫概述
本方案旨在為食品藥物管理署（TFDA）現行的「醫療器材查驗登記電子化送件系統」導入 <span style="color: coral">人工智慧輔助審查 (AI-Assisted Review)</span> 機制。根據最新的使用者調查（N=41），審查人員在資料存取與追蹤上給予系統肯定（4.05/5），但在 <span style="color: coral">海量資料檢索</span>、<span style="color: coral">介面操作效率</span> 及 <span style="color: coral">技術文件比對</span> 上面臨顯著瓶頸。本計畫提出構建「TFDA 智慧審查助理 (Smart Review Assistant)」，作為現有系統的外掛或整合模組。
1.2 目標用戶
TFDA 承辦人員：負責案件初審、實質審查與行政流程。
TFDA 覆核人員：負責決策覆核與一致性確認。
CDE (醫藥品查驗中心) 審查員：負責技術文件與臨床前測試報告的深度審查。
1.3 核心價值主張
本方案直接回應調查中排序前三名的 AI 需求：
智慧摘要引擎：針對 <span style="color: coral">臨床前測試報告</span> 與技術文件進行自動摘要，縮短 40% 的閱讀時間。
自動一致性稽核：利用 NLP 技術自動標記 <span style="color: coral">產品說明書 (IFU)</span> 與技術報告之間的規格不一致，提升審查精準度。
同類產品比對助手：自動檢索歷史資料庫，生成 <span style="color: coral">實質等效 (Substantial Equivalence)</span> 比對表，解決耗時的人工查找問題。
1.4 監管定位
本系統定位為 <span style="color: coral">第二級醫療器材軟體 (SaMD)</span> 概念下的 臨床決策支援工具 (CDS)，但在行政審查脈絡中，屬於 審查輔助系統。系統提供的所有摘要、標記與建議僅供參考，最終准駁權限仍完全屬於 <span style="color: coral">人類審查員 (Human-in-the-loop)</span>。
2. 現況痛點與需求對應 (Gap Analysis)
基於使用者調查報告，本方案針對性地解決以下核心問題：
調查痛點 (Pain Points)	影響評估	解決方案模組	預期效益
大量送審資料的檢索 (41.46%)	檔案散落在不同資料夾，關鍵字搜尋困難，導致審查中斷。	<span style="color: coral">語義搜尋引擎 (Semantic Search Engine)</span>	透過 RAG 技術，允許使用者以自然語言提問（如：「查詢此產品的生物相容性測試結果」），系統直接定位至 PDF 具體頁數。
技術文件與臨床前測試報告審查 (41.46%)	報告動輒數百頁，閱讀與消化資訊極為耗時。	<span style="color: coral">智慧文件摘要 (Intelligent Document Summarization)</span>	自動生成結構化摘要（目的、方法、結果、結論），並標註異常數值。
與同類器材比對表之比對確認 (31.71%)	需人工開啟多個視窗，肉眼比對規格參數。	<span style="color: coral">自動比對矩陣 (Auto-Comparison Matrix)</span>	AI 自動提取本次案件與資料庫中類似產品的參數，生成並列比對表。
介面操作便利性與系統變慢 (24.39%)	點擊次數過多，尖峰時刻載入慢。	<span style="color: coral">非同步預處理 (Asynchronous Pre-processing)</span>	在廠商送件後、承辦人打開前，系統於背景完成 OCR 與向量化，審查時達到「秒開」體驗。
3. 系統架構 (System Architecture)
3.1 高階架構圖
code
Mermaid
graph TB
    subgraph "使用者層 (Frontend)"
        WebUI[TFDA 智慧審查工作台<br/>React/Streamlit]
        Upload[廠商送件入口]
    end

    subgraph "應用層 (Application Core)"
        Orchestrator[<span style="color: coral">流程編排器 (Orchestrator)</span>]
        ContextMgr[上下文管理器]
        PII_Filter[<span style="color: coral">PII 去識別化模組</span>]
    end

    subgraph "知識檢索層 (RAG Layer)"
        VectorDB[<span style="color: coral">向量資料庫 (Vector DB)</span><br/>Milvus/Qdrant]
        DocParser[文件解析器<br/>OCR/PDF Layout]
        KeywordSearch[全文檢索引擎<br/>Elasticsearch]
    end

    subgraph "模型服務層 (Model Layer)"
        LLM_Gateway[<span style="color: coral">LLM 閘道器</span>]
        Commercial[Azure OpenAI / Gemini]
        Local[<span style="color: coral">Taiwan-LLM (本地部署)</span>]
    end

    subgraph "資料層 (Data Layer)"
        HistoricalDB[歷史案件資料庫]
        ReviewLog[審查紀錄資料庫]
    end

    Upload --> DocParser
    DocParser --> VectorDB
    WebUI --> Orchestrator
    Orchestrator --> PII_Filter
    PII_Filter --> LLM_Gateway
    LLM_Gateway --> Commercial
    LLM_Gateway --> Local
    Orchestrator --> VectorDB
    Orchestrator --> KeywordSearch
    VectorDB -.-> HistoricalDB
3.2 關鍵技術堆疊
前端框架：React.js (整合至現有系統) 或 Streamlit (獨立 POC)。
後端服務：Python (FastAPI)，利用其豐富的 AI 生態系。
文件處理：Unstructured.io 或 Microsoft Azure Document Intelligence (處理掃描檔 OCR)。
向量資料庫：<span style="color: coral">Qdrant</span> 或 <span style="color: coral">Milvus</span> (支援混合搜尋)。
模型框架：LangChain 或 LlamaIndex。
4. 軟體需求規格 (SRS)
4.1 功能性需求 (Functional Requirements)
FR-001: 跨文件一致性自動稽核 (Auto-Inconsistency Check)
需求描述：系統應能自動比對「申請書」、「產品說明書 (IFU)」與「技術性報告」之間的關鍵資訊（如：產品型號、滅菌方式、效能規格）。
輸入：PDF/Word 格式之送件資料。
處理：AI 實體提取 (Entity Extraction) 後進行邏輯比對。
輸出：<span style="color: coral">差異報告 (Discrepancy Report)</span>，列出不一致的欄位、頁碼與原始文字片段。
驗收標準：準確率需達 90% 以上，並提供人工修正介面。
FR-002: 臨床前測試報告智慧摘要 (Pre-clinical Summary)
需求描述：針對生物相容性、電氣安全、軟體確效等測試報告，生成結構化摘要。
處理：需識別測試標準（如 ISO 10993）、測試方法、通過/失敗結果。
輸出：Markdown 格式摘要，包含 <span style="color: coral">紅燈警示 (Red Flags)</span>（如測試結果為 Failed 或 Deviated）。
FR-003: 實質等效性比對 (Substantial Equivalence Analysis)
需求描述：使用者輸入「對照器材 (Predicate Device)」的許可證字號，系統自動調閱歷史資料庫，與本次申請案進行比對。
輸出：<span style="color: coral">比對矩陣表 (Comparison Matrix)</span>，涵蓋適應症、技術特點、材料等維度。
FR-004: 智慧語義檢索 (Semantic Search)
需求描述：解決「找不到檔案」的痛點。使用者可輸入自然語言查詢。
範例：「請列出所有與 ISO 14971 風險管理相關的附件」。
輸出：條列相關檔案連結，並直接跳轉至引用頁面。
4.2 非功能性需求 (Non-Functional Requirements)
NFR-001 回應速度：摘要生成需在 2 分鐘內完成；語義搜尋需在 <span style="color: coral">3 秒</span> 內回傳結果。
NFR-002 可用性：介面需支援雙螢幕操作（左側原文、右側 AI 輔助），並提供 <span style="color: coral">來源引用 (Citation)</span> 功能，點擊 AI 生成內容可亮顯原始文件位置。
NFR-003 擴充性：需保留 API 接口，以便未來介接公文系統。
5. AI 模型策略與選型 (AI Strategy)
考慮到 TFDA 為政府機關，資料敏感度高，本方案採取 <span style="color: coral">混合模型策略 (Hybrid Model Strategy)</span>。
任務類型	推薦模型方案	理由	資料隱私等級
一般摘要與翻譯	<span style="color: coral">Azure OpenAI (GPT-4o)</span> (機房落地版)	邏輯推演能力最強，處理複雜醫療文本效果最佳。	中 (企業級合規)
敏感個資處理	<span style="color: coral">Taiwan-LLM / Llama 3</span> (地端部署)	確保 PII (病患資料、廠商專利) 不出內網。	高 (完全隔離)
向量檢索 (Embedding)	<span style="color: coral">OpenAI text-embedding-3</span> 或 <span style="color: coral">BGE-M3</span>	支援長文本與多語言檢索。	-
5.1 提示詞工程 (Prompt Engineering) 規範
所有系統提示詞 (System Prompts) 需經過版本控制，並針對醫療器材法規進行微調。
範例：「你是一位資深的 TFDA 審查員，請依據 <span style="color: coral">醫療器材查驗登記審查準則</span>，檢查以下技術文件的完整性...」
6. 安全性與合規性考量 (Security & Compliance)
針對調查中提及的「資料安全」與「公文整合」需求，提出以下安全架構。
6.1 PII 去識別化 (De-identification)
在將資料送往雲端模型（如 Azure OpenAI）前，必須經過 <span style="color: coral">PII 過濾層</span>。
機制：使用 NLP 模型（如 Microsoft Presidio）自動識別並遮罩姓名、身分證號、病歷號。
還原：AI 回傳結果後，於地端伺服器進行實體還原，確保審查員看到的是正確資訊。
6.2 權限隔離 (RBAC)
承辦人僅能使用 AI 查詢自己負責的案件。
覆核人員可查詢所有案件，但操作紀錄需被 <span style="color: coral">完整稽核 (Audit Log)</span>。
歷史資料庫的 AI 訓練需確保不洩露廠商的商業機密 (Trade Secrets)。
6.3 部署合規
優先選擇通過 ISO 27001、HIPAA 認證的雲端服務。
若預算允許，建議建立 <span style="color: coral">政府專用私有雲 (Gov Private Cloud)</span> 運行地端大模型。
7. 基礎設施與部署方案 (Infrastructure & Deployment)
7.1 選項 A：混合雲架構 (推薦)
架構：敏感資料處理與文件解析在 TFDA 內網伺服器進行；去識別化後的摘要任務透過 VPN 傳送至 Azure OpenAI (Japan/Taiwan Region)。
優點：平衡了模型效能與資安合規。
成本：中等。
7.2 選項 B：全地端部署 (On-Premise)
架構：採購高規格 GPU 伺服器（如 NVIDIA H100/A100 叢集），自行部署開源模型 (Llama 3 70B)。
優點：資料完全不出門，資安最高等級。
缺點：初期建置成本極高，維護與模型更新困難，且開源模型在中文醫療邏輯上可能不如 GPT-4。
7.3 基礎設施即程式碼 (IaC) 範例 (Terraform)
code
Hcl
# 定義 Azure OpenAI 資源 (若採選項 A)
resource "azurerm_cognitive_account" "tfda_openai" {
  name                = "tfda-ai-service"
  location            = "Japan East"
  resource_group_name = azurerm_resource_group.tfda_rg.name
  kind                = "OpenAI"
  sku_name            = "S0"
  
  # 限制僅允許 TFDA 內網 IP 存取
  network_acls {
    default_action = "Deny"
    ip_rules       = ["210.69.x.x"] 
  }
}

# 定義向量資料庫容器 (地端或雲端)
resource "kubernetes_deployment" "qdrant" {
  metadata {
    name = "qdrant-db"
    labels = {
      app = "vector-db"
    }
  }
  spec {
    replicas = 2
    template {
      spec {
        container {
          image = "qdrant/qdrant:latest"
          name  = "qdrant"
          port {
            container_port = 6333
          }
        }
      }
    }
  }
}
8. 驗證與測試計畫 (Validation Plan)
依據 GAMP 5 指南與軟體確效原則進行。
8.1 準確性測試 (Accuracy Testing)
建立 <span style="color: coral">黃金標準資料集 (Gold Standard Dataset)</span>：選取 50 件已結案的歷史案件。
比較 AI 生成的摘要/比對表與人類審查員的原始報告。
指標：ROUGE 分數 (摘要相似度)、F1-Score (實體提取準確率)。目標需達 0.85 以上。
8.2 幻覺測試 (Hallucination Testing)
設計對抗性攻擊 (Adversarial Attacks) 測試，輸入含有錯誤資訊的文件，確認 AI 是否能識別而非照單全收。
要求 AI 提供每一個生成的 <span style="color: coral">事實核查來源連結 (Fact-checking Links)</span>。
8.3 壓力測試
模擬尖峰時段（如週五下午）同時 50 人上傳大型 PDF 的情境，確保系統不崩潰，且佇列處理機制 (Queueing) 正常運作。
9. 實施路徑與預算評估 (Roadmap)
第一階段：概念驗證 (PoC) - 3個月
範圍：針對單一類別器材（如第二級軟體），開發「智慧摘要」與「語義搜尋」功能。
目標：驗證 AI 對中文醫療法規文件的理解能力。
預算：約 NT$ 150 - 200 萬。
第二階段：試點運行 (Pilot) - 6個月
範圍：擴大至「技術文件比對」與「不一致性稽核」。整合至測試環境的電子送件系統。
目標：邀請 10 位資深審查員進行試用與回饋，優化 <span style="color: coral">人機協作介面 (UI/UX)</span>。
預算：約 NT$ 500 - 800 萬 (含 GPU 伺服器或雲端點數)。
第三階段：全面上線 (Full Rollout) - 12個月
範圍：全類別器材適用，介接公文系統，導入歷史案件知識庫。
目標：正式發布，並建立 AI 模型定期再訓練機制。
預算：視架構而定，年度維護約 NT$ 300 萬+。
10. 附錄：關鍵風險評估
風險項目	可能性	影響程度	緩解措施
AI 產生幻覺 (Hallucination)	中	高	介面強制顯示「原文引用來源」；在輸出上標註「AI 生成，請人工核實」警語。
資料外洩	低	極高	採用 Azure OpenAI 企業版 (不拿資料訓練) 或地端模型；實施嚴格的 PII 去識別化。
審查員過度依賴	中	中	教育訓練強調 AI 僅為輔助；系統不定時加入「陷阱題」測試審查員是否有認真核對。
廠商抗議審查不公	低	高	公開 AI 使用原則與範圍；保留 AI 運算的所有 <span style="color: coral">歷程紀錄 (Logs)</span> 以供申訴時調閱。
本文件為可行性評估草案，具體技術細節需視 TFDA 最終資安政策與預算規模調整。
